import{_ as e}from"./uni-icons.BQCc16_L.js";import{d as t,e as s,j as i,f as o,w as l,k as r,y as a,x as n,m as u,v as h,F as c,H as d,aH as m,I as f,i as p,K as g,J as y,l as b,t as _,q as S}from"./index-CPBjD6nT.js";import"./uni-forms.vue_vue_type_style_index_0_scoped_a2a9907e_lang.DTEDUJsm.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";function v(e){let t="";for(let s in e){t+=`${s}:${e[s]};`}return t}const C=x({name:"uni-easyinput",emits:["click","iconClick","update:modelValue","input","focus","blur","confirm","clear","eyes","change","keyboardheightchange"],model:{prop:"modelValue",event:"update:modelValue"},options:{virtualHost:!0},inject:{form:{from:"uniForm",default:null},formItem:{from:"uniFormItem",default:null}},props:{name:String,value:[Number,String],modelValue:[Number,String],type:{type:String,default:"text"},clearable:{type:Boolean,default:!0},autoHeight:{type:Boolean,default:!1},placeholder:{type:String,default:" "},placeholderStyle:String,focus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxlength:{type:[Number,String],default:140},confirmType:{type:String,default:"done"},clearSize:{type:[Number,String],default:24},inputBorder:{type:Boolean,default:!0},prefixIcon:{type:String,default:""},suffixIcon:{type:String,default:""},trim:{type:[Boolean,String],default:!1},cursorSpacing:{type:Number,default:0},passwordIcon:{type:Boolean,default:!0},adjustPosition:{type:Boolean,default:!0},primaryColor:{type:String,default:"#2979ff"},styles:{type:Object,default:()=>({color:"#333",backgroundColor:"#fff",disableColor:"#F7F6F6",borderColor:"#e5e5e5"})},errorMessage:{type:[String,Boolean],default:""}},data:()=>({focused:!1,val:"",showMsg:"",border:!1,isFirstBorder:!1,showClearIcon:!1,showPassword:!1,focusShow:!1,localMsg:"",isEnter:!1}),computed:{isVal(){const e=this.val;return!(!e&&0!==e)},msg(){return this.localMsg||this.errorMessage},inputMaxlength(){return Number(this.maxlength)},boxStyle(){return`color:${this.inputBorder&&this.msg?"#e43d33":this.styles.color};`},inputContentClass(){return function(e){let t="";for(let s in e)e[s]&&(t+=`${s} `);return t}({"is-input-border":this.inputBorder,"is-input-error-border":this.inputBorder&&this.msg,"is-textarea":"textarea"===this.type,"is-disabled":this.disabled,"is-focused":this.focusShow})},inputContentStyle(){const e=this.focusShow?this.primaryColor:this.styles.borderColor;return v({"border-color":(this.inputBorder&&this.msg?"#dd524d":e)||"#e5e5e5","background-color":this.disabled?this.styles.disableColor:this.styles.backgroundColor})},inputStyle(){return v({"padding-right":"password"===this.type||this.clearable||this.prefixIcon?"":"10px","padding-left":this.prefixIcon?"":"10px"})}},watch:{value(e){this.val=e},modelValue(e){this.val=e},focus(e){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))}},created(){this.init(),this.form&&this.formItem&&this.$watch("formItem.errMsg",(e=>{this.localMsg=e}))},mounted(){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))},methods:{init(){this.value||0===this.value?this.val=this.value:this.modelValue||0===this.modelValue||""===this.modelValue?this.val=this.modelValue:this.val=null},onClickIcon(e){this.$emit("iconClick",e)},onEyes(){this.showPassword=!this.showPassword,this.$emit("eyes",this.showPassword)},onInput(e){let t=e.detail.value;this.trim&&("boolean"==typeof this.trim&&this.trim&&(t=this.trimStr(t)),"string"==typeof this.trim&&(t=this.trimStr(t,this.trim))),this.errMsg&&(this.errMsg=""),this.val=t,this.$emit("input",t),this.$emit("update:modelValue",t)},onFocus(){this.$nextTick((()=>{this.focused=!0})),this.$emit("focus",null)},_Focus(e){this.focusShow=!0,this.$emit("focus",e)},onBlur(){this.focused=!1,this.$emit("blur",null)},_Blur(e){if(e.detail.value,this.focusShow=!1,this.$emit("blur",e),!1===this.isEnter&&this.$emit("change",this.val),this.form&&this.formItem){const{validateTrigger:e}=this.form;"blur"===e&&this.formItem.onFieldChange()}},onConfirm(e){this.$emit("confirm",this.val),this.isEnter=!0,this.$emit("change",this.val),this.$nextTick((()=>{this.isEnter=!1}))},onClear(e){this.val="",this.$emit("input",""),this.$emit("update:modelValue",""),this.$emit("clear")},onkeyboardheightchange(e){this.$emit("keyboardheightchange",e)},trimStr:(e,t="both")=>"both"===t?e.trim():"left"===t?e.trimLeft():"right"===t?e.trimRight():"start"===t?e.trimStart():"end"===t?e.trimEnd():"all"===t?e.replace(/\s+/g,""):e}},[["render",function(g,y,b,_,S,x){const v=t(s("uni-icons"),e),C=m,w=f,k=p;return i(),o(k,{class:a(["uni-easyinput",{"uni-easyinput-error":x.msg}]),style:n(x.boxStyle)},{default:l((()=>[r(k,{class:a(["uni-easyinput__content",x.inputContentClass]),style:n(x.inputContentStyle)},{default:l((()=>[b.prefixIcon?(i(),o(v,{key:0,class:"content-clear-icon",type:b.prefixIcon,color:"#c0c4cc",onClick:y[0]||(y[0]=e=>x.onClickIcon("prefix")),size:"22"},null,8,["type"])):u("",!0),h(g.$slots,"left",{},void 0,!0),"textarea"===b.type?(i(),o(C,{key:1,class:a(["uni-easyinput__content-textarea",{"input-padding":b.inputBorder}]),name:b.name,value:S.val,placeholder:b.placeholder,placeholderStyle:b.placeholderStyle,disabled:b.disabled,"placeholder-class":"uni-easyinput__placeholder-class",maxlength:x.inputMaxlength,focus:S.focused,autoHeight:b.autoHeight,"cursor-spacing":b.cursorSpacing,"adjust-position":b.adjustPosition,onInput:x.onInput,onBlur:x._Blur,onFocus:x._Focus,onConfirm:x.onConfirm,onKeyboardheightchange:x.onkeyboardheightchange},null,8,["class","name","value","placeholder","placeholderStyle","disabled","maxlength","focus","autoHeight","cursor-spacing","adjust-position","onInput","onBlur","onFocus","onConfirm","onKeyboardheightchange"])):(i(),o(w,{key:2,type:"password"===b.type?"text":b.type,class:"uni-easyinput__content-input",style:n(x.inputStyle),name:b.name,value:S.val,password:!S.showPassword&&"password"===b.type,placeholder:b.placeholder,placeholderStyle:b.placeholderStyle,"placeholder-class":"uni-easyinput__placeholder-class",disabled:b.disabled,maxlength:x.inputMaxlength,focus:S.focused,confirmType:b.confirmType,"cursor-spacing":b.cursorSpacing,"adjust-position":b.adjustPosition,onFocus:x._Focus,onBlur:x._Blur,onInput:x.onInput,onConfirm:x.onConfirm,onKeyboardheightchange:x.onkeyboardheightchange},null,8,["type","style","name","value","password","placeholder","placeholderStyle","disabled","maxlength","focus","confirmType","cursor-spacing","adjust-position","onFocus","onBlur","onInput","onConfirm","onKeyboardheightchange"])),"password"===b.type&&b.passwordIcon?(i(),c(d,{key:3},[x.isVal?(i(),o(v,{key:0,class:a(["content-clear-icon",{"is-textarea-icon":"textarea"===b.type}]),type:S.showPassword?"eye-slash-filled":"eye-filled",size:22,color:S.focusShow?b.primaryColor:"#c0c4cc",onClick:x.onEyes},null,8,["class","type","color","onClick"])):u("",!0)],64)):b.suffixIcon?(i(),c(d,{key:4},[b.suffixIcon?(i(),o(v,{key:0,class:"content-clear-icon",type:b.suffixIcon,color:"#c0c4cc",onClick:y[1]||(y[1]=e=>x.onClickIcon("suffix")),size:"22"},null,8,["type"])):u("",!0)],64)):(i(),c(d,{key:5},[b.clearable&&x.isVal&&!b.disabled&&"textarea"!==b.type?(i(),o(v,{key:0,class:a(["content-clear-icon",{"is-textarea-icon":"textarea"===b.type}]),type:"clear",size:b.clearSize,color:x.msg?"#dd524d":S.focusShow?b.primaryColor:"#c0c4cc",onClick:x.onClear},null,8,["class","size","color","onClick"])):u("",!0)],64)),h(g.$slots,"right",{},void 0,!0)])),_:3},8,["class","style"])])),_:3},8,["class","style"])}],["__scopeId","data-v-124e9208"]]);const w=x({name:"uniFormsItem",options:{virtualHost:!0},provide(){return{uniFormItem:this}},inject:{form:{from:"uniForm",default:null}},props:{rules:{type:Array,default:()=>null},name:{type:[String,Array],default:""},required:{type:Boolean,default:!1},label:{type:String,default:""},labelWidth:{type:[String,Number],default:""},labelAlign:{type:String,default:""},errorMessage:{type:[String,Boolean],default:""},leftIcon:String,iconColor:{type:String,default:"#606266"}},data:()=>({errMsg:"",userRules:null,localLabelAlign:"left",localLabelWidth:"70px",localLabelPos:"left",border:!1,isFirstBorder:!1}),computed:{msg(){return this.errorMessage||this.errMsg}},watch:{"form.formRules"(e){this.init()},"form.labelWidth"(e){this.localLabelWidth=this._labelWidthUnit(e)},"form.labelPosition"(e){this.localLabelPos=this._labelPosition()},"form.labelAlign"(e){}},created(){this.init(!0),this.name&&this.form&&this.$watch((()=>this.form._getDataValue(this.name,this.form.localData)),((e,t)=>{if(!this.form._isEqual(e,t)){const t=this.itemSetValue(e);this.onFieldChange(t,!1)}}),{immediate:!1})},unmounted(){this.__isUnmounted=!0,this.unInit()},methods:{setRules(e=null){this.userRules=e,this.init(!1)},setValue(){},async onFieldChange(e,t=!0){const{formData:s,localData:i,errShowType:o,validateCheck:l,validateTrigger:r,_isRequiredField:a,_realName:n}=this.form,u=n(this.name);e||(e=this.form.formData[u]);const h=this.itemRules.rules&&this.itemRules.rules.length;if(!this.validator||!h||0===h)return;const c=a(this.itemRules.rules||[]);let d=null;return"bind"===r||t?(d=await this.validator.validateUpdate({[u]:e},s),c||void 0!==e&&""!==e||(d=null),d&&d.errorMessage?("undertext"===o&&(this.errMsg=d?d.errorMessage:""),"toast"===o&&g({title:d.errorMessage||"校验错误",icon:"none"}),"modal"===o&&y({title:"提示",content:d.errorMessage||"校验错误"})):this.errMsg="",l(d||null)):this.errMsg="",d||null},init(e=!1){const{validator:t,formRules:s,childrens:i,formData:o,localData:l,_realName:r,labelWidth:a,_getDataValue:n,_setDataValue:u}=this.form||{};if(this.localLabelAlign=this._justifyContent(),this.localLabelWidth=this._labelWidthUnit(a),this.localLabelPos=this._labelPosition(),this.form&&e&&i.push(this),!t||!s)return;this.form.isFirstBorder||(this.form.isFirstBorder=!0,this.isFirstBorder=!0),this.group&&(this.group.isFirstBorder||(this.group.isFirstBorder=!0,this.isFirstBorder=!0)),this.border=this.form.border;const h=r(this.name),c=this.userRules||this.rules;"object"==typeof s&&c&&(s[h]={rules:c},t.updateSchema(s));const d=s[h]||{};this.itemRules=d,this.validator=t,this.itemSetValue(n(this.name,l))},unInit(){if(this.form){const{childrens:e,formData:t,_realName:s}=this.form;e.forEach(((e,i)=>{e===this&&(this.form.childrens.splice(i,1),delete t[s(e.name)])}))}},itemSetValue(e){const t=this.form._realName(this.name),s=this.itemRules.rules||[],i=this.form._getValue(t,e,s);return this.form._setDataValue(t,this.form.formData,i),i},clearValidate(){this.errMsg=""},_isRequired(){return this.required},_justifyContent(){if(this.form){const{labelAlign:e}=this.form;let t=this.labelAlign?this.labelAlign:e;if("left"===t)return"flex-start";if("center"===t)return"center";if("right"===t)return"flex-end"}return"flex-start"},_labelWidthUnit(e){return this.num2px(this.labelWidth?this.labelWidth:e||(this.label?70:"auto"))},_labelPosition(){return this.form&&this.form.labelPosition||"left"},isTrigger:(e,t,s)=>"submit"!==e&&e?"bind":void 0===e?"bind"!==t?t?"submit":""===s?"bind":"submit":"bind":"submit",num2px:e=>"number"==typeof e?`${e}px`:e}},[["render",function(e,t,s,c,d,m){const f=S,g=p;return i(),o(g,{class:a(["uni-forms-item",["is-direction-"+d.localLabelPos,d.border?"uni-forms-item--border":"",d.border&&d.isFirstBorder?"is-first-border":""]])},{default:l((()=>[h(e.$slots,"label",{},(()=>[r(g,{class:a(["uni-forms-item__label",{"no-label":!s.label&&!s.required}]),style:n({width:d.localLabelWidth,justifyContent:d.localLabelAlign})},{default:l((()=>[s.required?(i(),o(f,{key:0,class:"is-required"},{default:l((()=>[b("*")])),_:1})):u("",!0),r(f,null,{default:l((()=>[b(_(s.label),1)])),_:1})])),_:1},8,["class","style"])]),!0),r(g,{class:"uni-forms-item__content"},{default:l((()=>[h(e.$slots,"default",{},void 0,!0),r(g,{class:a(["uni-forms-item__error",{"msg--active":m.msg}])},{default:l((()=>[r(f,null,{default:l((()=>[b(_(m.msg),1)])),_:1})])),_:1},8,["class"])])),_:3})])),_:3},8,["class"])}],["__scopeId","data-v-ab882ba0"]]);export{C as _,w as a};
