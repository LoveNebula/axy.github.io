import{b as t,V as a,U as l,K as s,d as n,e as i,f as o,w as d,i as r,j as c,k as u,l as f,t as m,F as h,G as p,H as _}from"./index-CPBjD6nT.js";import{_ as g}from"./uni-datetime-picker.Skz1SJ_2.js";import{_ as y}from"./uv-tags.CFwmOo6T.js";import{e as x}from"./bizScheduApi.BbFgL-ID.js";import{h as w}from"./html2canvas.esm.B-p-w7uj.js";import{_ as v}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.BQCc16_L.js";/* empty css                                                                  */import"./uv-icon.BeAryk0A.js";import"./uv-transition.57FirIXI.js";const b={data:()=>({}),methods:{getDpr:()=>window.devicePixelRatio&&window.devicePixelRatio>1?window.devicePixelRatio:1,parseValue:e=>parseInt(e,10),generateImage(e,t){var a=this;document.getElementById("container").style.opacity="1";var l=document.getElementById("container"),s=window.getComputedStyle(l),n=a.parseValue(s.width),i=a.parseValue(s.height),o=a.getDpr(),d=document.createElement("canvas");d.width=n*o,d.height=i*o,d.style.width=n+"px",d.style.height=i+"px",d.getContext("2d").scale(o,o),document.getElementById("container").style.width,document.getElementById("container").style.height,w(l,{allowTaint:!1,width:window.clientWidth,height:window.clientHeight,backgroundColor:"green",useCORS:!0}).then((function(e){let a=e.toDataURL("image/png");t.callMethod("getSaveImg",{base64data:a})}))}}},k=e=>{e.$renderjs||(e.$renderjs=[]),e.$renderjs.push("canvasToImage"),e.mixins||(e.mixins=[]),e.mixins.push({beforeCreate(){this.canvasToImage=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),e.mixins.push(b)},j={data:()=>({dateData:uni.$nowDate,sChecker:"",listAll:[],userInfo:"",data:{}}),mounted(){this.data=t("storage_data"),this.userInfo=this.data.userInfo},onShow(){x({departureDate:this.dateData,checkState:2}).then((e=>{console.log(e,"PAGE"),this.listAll=e.data.records;const t=this.listAll.map((e=>e.checker));this.sChecker=[...new Set(t)].filter((e=>""!==e&&null!==e)).join()}))},methods:{dateChange(e){console.log("e",e),this.dateData=e,x({departureDate:e,checkState:2}).then((e=>{this.listAll=e.data.records}))},getSaveImg(t){a({title:"正在保存···"});let n=t.base64data,i=new plus.nativeObj.Bitmap("test");i.loadBase64Data(n,(function(){console.log("加载Base64图片数据成功");let e="_downloads/test2.png";i.save(e,{},(function(t){console.log("保存图片成功："+JSON.stringify(t)),l({filePath:e,success:function(){s({title:"图片保存成功",icon:"success",duration:789}),plus.io.resolveLocalFileSystemURL(e,(function(e){e.getMetadata((function(t){e.remove()}))}),(function(e){console.log("error"+e)})),i.clear()}}),i.clear()}),(function(e){onsole.log("保存图片失败："+JSON.stringify(e)),i.clear()}))}),(function(){console.log("加载Base64图片数据失败："+JSON.stringify(e)),i.clear()}))},stateChange(e){switch(e){case-1:return"暂存";case 0:return"已提交";case 1:return"已确认";case 2:return"已发布"}}}};k(j);const I=v(j,[["render",function(e,t,a,l,s,x){const w=r,v=n(i("uni-datetime-picker"),g),b=n(i("uv-tags"),y);return c(),o(w,{class:"importMain"},{default:d((()=>[u(w,{class:"listBox",id:"container"},{default:d((()=>[u(w,{class:"flexStart",style:{"margin-left":"5px","margin-top":"15px"}},{default:d((()=>[u(w,null,{default:d((()=>[f(" 选择出班日期：")])),_:1}),u(w,null,{default:d((()=>[u(v,{style:{width:"200px"},type:"date","clear-icon":!1,modelValue:s.dateData,"onUpdate:modelValue":t[0]||(t[0]=e=>s.dateData=e),onChange:x.dateChange},null,8,["modelValue","onChange"])])),_:1})])),_:1}),u(w,{class:"flexColumn",style:{"margin-left":"5px","margin-top":"15px"}},{default:d((()=>[u(w,{style:{"font-size":"18px","font-weight":"bold"}},{default:d((()=>[f(" 审核发布："+m(s.sChecker),1)])),_:1}),u(w,{style:{"margin-top":"10px",width:"100%"}},{default:d((()=>[u(w,{class:"table_header"},{default:d((()=>[u(w,{style:{flex:"1"},class:"header_item"},{default:d((()=>[f("组长")])),_:1}),u(w,{style:{flex:"1"},class:"header_item"},{default:d((()=>[f("组员")])),_:1}),u(w,{style:{width:"33%"},class:"header_item"},{default:d((()=>[f("仪器")])),_:1}),u(w,{style:{flex:"1"},class:"header_item"},{default:d((()=>[f("车辆")])),_:1}),u(w,{style:{flex:"1"},class:"header_item"},{default:d((()=>[f("司机")])),_:1})])),_:1}),u(w,{class:"table_body"},{default:d((()=>[(c(!0),h(_,null,p(s.listAll,((t,a)=>(c(),o(w,{class:"body_item",key:a},{default:d((()=>[u(w,{class:"body_content"},{default:d((()=>[u(w,{class:"body_content_item"},{default:d((()=>[u(w,null,{default:d((()=>[f(m(t.projectId),1)])),_:2},1024),u(w,{style:{display:"flex","align-items":"center"}},{default:d((()=>[u(w,{class:"item_left"},{default:d((()=>[f(m(t.name),1)])),_:2},1024),u(w,{class:"item_right"},{default:d((()=>[u(b,{text:x.stateChange(t.checkState),plain:""},null,8,["text"])])),_:2},1024)])),_:2},1024)])),_:2},1024),u(w,{class:"body_item_content"},{default:d((()=>[u(w,{style:{flex:"1"},class:"content_item"},{default:d((()=>[f(m(t.leader),1)])),_:2},1024),u(w,{style:{display:"flex",flex:"1","align-items":"center","justify-content":"center"},class:"content_item"},{default:d((()=>["[]"==t.members||null==t.members?(c(),o(w,{key:0})):(c(),o(w,{key:1,style:{display:"flex","flex-direction":"column",padding:"5px 0"}},{default:d((()=>[(c(!0),h(_,null,p(t.members.split(","),((e,t)=>(c(),o(w,{key:t},{default:d((()=>[f(m(e),1)])),_:2},1024)))),128))])),_:2},1024))])),_:2},1024),u(w,{style:{width:"33%","border-right":"1px solid","font-size":"14px"}},{default:d((()=>["[]"==t.device||null==t.device?(c(),h("p",{key:0})):(c(),o(w,{key:1},{default:d((()=>[(c(!0),h(_,null,p(t.device.split(","),((a,l)=>(c(),h("p",{key:e.sindex,style:{"word-wrap":"break-word"}},m(a)+" "+m(t.device.length>0?",":""),1)))),128))])),_:2},1024))])),_:2},1024),u(w,{style:{flex:"1"},class:"content_item"},{default:d((()=>[f(m(t.vehicle),1)])),_:2},1024),u(w,{style:{flex:"1"},class:"content_item"},{default:d((()=>[f(m(t.driver),1)])),_:2},1024)])),_:2},1024),u(w,{class:"body_header",style:{padding:"0 3px"}},{default:d((()=>[u(w,null,{default:d((()=>[f(m(t.recordMaker),1)])),_:2},1024),u(w,{style:{"font-size":"14px",color:"#000"}},{default:d((()=>[f(m(t.notes),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-faaefd58"]]);export{I as default};
